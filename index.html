<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" >
  <meta name="description" content="Map of Cameron County Resacas">
  <meta name="author" content="Anna Novak">
  <title>Cameron County Resacas Map</title>


<!-- CSS style sheets and Javascript libraries for Leaflet, jQuery, ESRI-Leaflet  -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
  integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
  crossorigin=""/>
<script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
  integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
  crossorigin=""></script>
<script src="https://unpkg.com/esri-leaflet@2.1.4"></script>

<!-- Esri Leaflet Geocoder style sheet -->
<link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.12/dist/esri-leaflet-geocoder.css">
<script src="https://unpkg.com/esri-leaflet-geocoder"></script>

  <!-- CSS for testing -->
  <style>
  body { padding: 0; margin: 0;}
  html, body, #map { height: 100%;}
  </style>
</head>



<body>

<!-- map DIV object -->
<div id="map" style="width: 100%; height: 100%;"></div>

<!-- scripts to include external geoJson files -->
<script src="TR_Resacas_020618.js"></script>
<script src="RRV_aerial.js"></script>
<script src="RDLG_aerial.js"></script>
<script src="RDLF_aerial.js"></script>
<script src="RDLC_aerial.js"></script>

<script>

var mymap = L.map('map').setView([25.90, -97.49], 10);

/* variables to store base layer tiles */
var mapboxSatStreets = L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiYW1ub3ZhayIsImEiOiJjamlrcnVqM3kwY3ZoM3ZteWVlYWEwMWdmIn0.KaCmpHIRa0GRQpUTIrRYwQ', {
   maxZoom: 18,
   attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
   id: 'mapbox.streets',
});

/* Add base layer to the map */
mapboxSatStreets.addTo(mymap);





/* styling for feature layers */

var orange = {
  "color": "#ff7800",
  "weight": 2
};

var magenta = {
  "color": "#db04b0",
  "weight": 2
};

var blue = {
  "color": "#0259fc",
  "weight": 2,
};

var red = {
  "color": "#FF3B3B",
  "weight": 2
};


/* Create feature layers with scrollable popups containing all properties*/

var TR = L.geoJson(tr, {
  style: red,
  onEachFeature: function (feature, layer) {
    var popupcontent = []
    for (var prop in feature.properties) {
      popupcontent.push(prop + ":" + feature.properties[prop]);
    }
    layer.bindPopup(popupcontent.join("<br />"), {maxWidth: "auto", maxHeight: 250});
  }
});


// map.on('zoomend', function() {
//   map.getZoom();
// })

var RRV = L.geoJson(rrv, {
  style: blue,
  onEachFeature: function (feature, layer) {
    var popupcontent = []
    for (var prop in feature.properties) {
      popupcontent.push(prop + ":" + feature.properties[prop]);
    }
    layer.bindPopup(popupcontent.join("<br />"), {maxWidth: "auto", maxHeight: 250});
  },
//   if (map.getZoom() < 8) {
//   onEachFeature: function (feature, layer) {
//     var label = L.marker(layer.getBounds().getCenter(), {
//         icon: L.divIcon ({
//         className: 'label',
//         html: feature.properties.Short_Code,
//         iconSize: [100, 40]
//       })
//     }).addTo(mymap)
//   }
// }
});



var RDLG = L.geoJson(rdlg, {
  style: magenta,
  onEachFeature: function (feature, layer) {
    var popupcontent = []
    for (var prop in feature.properties) {
      popupcontent.push(prop + ":" + feature.properties[prop]);
    }
    layer.bindPopup(popupcontent.join("<br />"), {maxWidth: "auto", maxHeight: 250});
  }
});


var RDLF = L.geoJson(rdlf, {
  style: orange,
  onEachFeature: function (feature, layer) {
    var popupcontent = []
    for (var prop in feature.properties) {
      popupcontent.push(prop + ":" + feature.properties[prop]);
    }
    layer.bindPopup(popupcontent.join("<br />"), {maxWidth: "auto", maxHeight: 250});
  }
});


var RDLC = L.geoJson(rdlc, {
  style: red,
  onEachFeature: function (feature, layer) {
    var popupcontent = []
    for (var prop in feature.properties) {
      popupcontent.push(prop + ":" + feature.properties[prop]);
    }
    layer.bindPopup(popupcontent.join("<br />"), {maxWidth: "auto", maxHeight: 250});
  }
});




// Add feature layers to map
RRV.addTo(mymap);
TR.addTo(mymap);
RDLG.addTo(mymap);
RDLF.addTo(mymap);
RDLC.addTo(mymap);
// var aerial = L.layerGroup([TR, RRV, RDLG, RDLF, RDLC]);

/* Layer control */
var baseMaps = {
  "Satellite": mapboxSatStreets
};

var overlayMaps = {
  "TR": TR,
  "RRV": RRV,
  "RDLG": RDLG,
  "RDLF": RDLF,
  "RDLC": RDLC
};

L.control.layers(baseMaps, overlayMaps).addTo(mymap);


/* ESRI Geocoder search */
var searchControl = L.esri.Geocoding.geosearch().addTo(mymap);

// empty layer for results event
var results = L.layerGroup().addTo(mymap);

// listen for results event and add every result to the map
searchControl.on("results", function(data) {
  results.clearLayers();
  for (var i = data.results.length - 1; i >= 0; i--) {
    results.addLayer(L.marker(data.results[i].latlng));
  }
});


// for each layer, if the layer is ON, add/remove labels based on Zoom level




// Fit map to extent of features
mymap.fitBounds(RRV.getBounds());


</script>


</body>
</html>
